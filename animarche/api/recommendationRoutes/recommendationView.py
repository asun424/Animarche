from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
import tensorflow as tf
from tensorflow import keras
import numpy as np

# Create your views here.
class Recommend(APIView):
    def post(self, request, *args, **kwargs):
        score = request.data["score"]
        reference = ['Haikyuu', 'Tengen Toppa Gurren Lagann', 'Kimi Ni Todoke', 'Kaguya-sama', 'Shigatsu Wa Kimi No Uso', 'Barakamon', 'Durarara', 'Death Parade', 'Spirited Away', 'Samurai Champloo', 'Naruto', 'Lupin III', 'Inuyasha', 'Mob Psycho 100', 'Sangatsu No Lion', 'JoJo\s Bizarre Adventure Part 4: Diamond is Unbreakable', 'Golden Kamuy', 'Horimiya', 'Full Metal Alchemist', 'Gin No Saji', 'Akatsuki No Yona', 'Cyberpunk Edgerunners', 'Noragami', 'Chainsaw Man', 'Bocchi The Rock', 'Spy X Family', 'Ya Boy Kongming', 'Blood Blockade Battlefront', 'Showa Genroku Rakugo Shinjuu', 'Oddtaxi', 'Cowboy Bebop', 'Devilman Crybaby', 'Beastars', 'Eureka Seven', 'Deadman Wonderland', 'Banana Fish', 'Run With The Wind', 'Honey And Clover', 'Mirumo', 'Digimon Tamers', 'Ousama Ranking', 'Kimi Wa Houkago Insomnia', 'Mairimashita Irumakun', 'Welcome To The Ballroom', 'Jujutsu Kaisen', 'Soul Eater', 'Working', 'Mushi-shi', 'Bokura Wa Kawaii Minna Sou', 'Sweetness and Lightning']
        gifs = ['https://media.tenor.com/gUW6QAKAYfgAAAAC/hinata-anime.gif', 'https://media.tenor.com/0NktZdQEsvYAAAAd/gurren-lagann-tengen-toppa-gurren-lagann.gif', 'https://images6.fanpop.com/image/photos/33100000/Kimi-ni-Todoke-gifs-kimi-ni-todoke-33158620-500-270.gif', 'https://media.tenor.com/OlB9hb8iBOIAAAAd/kaguya-sama-love-is-war-kaguya-sama.gif', 'https://media.tenor.com/tMLFlHAxdfYAAAAd/shigatsu-wa-kimi-no-uso-ella.gif', 'https://64.media.tumblr.com/068ec6b408c52ab752d0eb7a4786ee79/054dd9d4997602d7-2b/s540x810/a2b738827ae24be59b0598e7046c7bfab50d011e.gif', 'https://media.tenor.com/9TVRfI9mTq4AAAAd/masaomi-kida-bang.gif', 'https://i0.wp.com/oocentral.ca/wp-content/uploads/2017/12/death-parade-death-parade-40394760-500-281.gif?w=651&h=366&ssl=1', 'https://i.pinimg.com/originals/96/18/6b/96186b308addc3c4700a26adb3aac278.gif', 'https://media.tenor.com/S6GB4aAtzDoAAAAd/samurai-champloo.gif', 'https://media.tenor.com/12s59XBmULkAAAAd/obito-uchiha-vs-kakashi-hatake-naruto-shippuden.gif', 'https://media.tenor.com/rJ7PJ_Qsw9oAAAAd/lupin-anime.gif', 'https://static.wikia.nocookie.net/vsbattles/images/a/a1/Inuyasha_Adamant_Barrage.gif/revision/latest?cb=20210403113813', 'https://media4.giphy.com/media/hzx9toaSQPHRm/giphy.gif', 'https://64.media.tumblr.com/23c59e43439ed9c3523b4febf6c34d3a/eacbdd602b2c6d44-c1/s540x810/77a6413b3bc03fbe8d8cc4838a40e16a95e42c63.gif', 'https://pa1.narvii.com/6068/b674a765c8865cd19ef7bd021ea15cc0cb288dfd_hq.gif', 'https://64.media.tumblr.com/3c2042e8bf2646bdaaaa381af7b577e4/229628c47bffdc4a-1a/s540x810/64ebd25e8e7b2bc08feb32440024d476cb36e383.gif', 'https://media.tenor.com/zkYQwVHHjPYAAAAC/horimiya-miyamura.gif', 'https://media.tenor.com/yD-dTKxhMkkAAAAd/fullmetal-alchemist-edward-elric.gif', 'https://64.media.tumblr.com/73073f0cbaa150d7a023751fab0d93f7/tumblr_odgc5aMyZk1slo5uzo1_540.gif', 'https://images.gr-assets.com/hostedimages/1625221720ra/31579169.gif', 'https://media3.giphy.com/media/c0PX1PqTeqhbtKMekM/giphy.gif?cid=6c09b952b4ef83a67bd88b7eb4ae70f6d69a09431a1ad79a&rid=giphy.gif&ct=g', 'https://i.pinimg.com/originals/a9/20/2c/a9202c36d987efb9afb27b4010c27655.gif', 'https://media1.giphy.com/media/YUIH59iWZ1gapi1IXC/giphy.gif', 'https://i.pinimg.com/originals/4c/7c/66/4c7c669c255123a68c2474ccf5ab7ab9.gif', 'https://gifdb.com/images/thumbnail/spy-x-family-dancing-anime-aesthetic-o2fitvpp5tncl6mv.gif', 'https://media.tenor.com/zUMO5r9X9K4AAAAd/ya-boy-kongming-paripi-koumei.gif', 'https://media.tenor.com/S-17O0pan4MAAAAd/zapp-zapp-renfro.gif', 'https://64.media.tumblr.com/e912aeb0c033d0d6ef9b5aac1f55f81e/tumblr_ojcxt4EHgb1w19j07o2_640.gif', 'https://media.tenor.com/iMxflWAs93IAAAAd/odd-taxi-odokawa.gif', 'https://thumbs.gfycat.com/PeskyRightAcornwoodpecker-size_restricted.gif', 'https://media.tenor.com/7AeP-x1OWToAAAAd/devilman-crybaby.gif', 'https://thumbs.gfycat.com/AncientHopefulFeline-size_restricted.gif', 'https://i.makeagif.com/media/2-03-2015/0wcjbn.gif', 'https://static.wikia.nocookie.net/vsbattles/images/f/f1/Ganta_Gun.gif/revision/latest?cb=20180406021506', 'https://media.tenor.com/c94t4Bd_dxIAAAAd/banana-fish-ash-banana-fish.gif', 'https://i0.wp.com/drunkenanimeblog.com/wp-content/uploads/2021/12/Run-w-the-Wind-key-visuals.gif?fit=538%2C302&ssl=1', 'https://otakucreativa.files.wordpress.com/2020/09/honeyandcloverg3.gif', 'https://media.tenor.com/6GrIR0k5HgoAAAAC/mirumo-mirmo.gif', 'https://media.tenor.com/GFQdNqTkN8cAAAAd/digimon-tamers-juri-katou.gif', 'https://media.tenor.com/zGAjO24K-vMAAAAd/ousama-ranking-bojji.gif', 'https://pbs.twimg.com/media/Flnlf9-WQAIz-Q4.jpg', 'https://media.tenor.com/NW5v3kzQ1eIAAAAd/welcome-to-demon-school-iruma-kun-friends.gif', 'https://pa1.narvii.com/6575/8b572b4c00b85532f919c59f1b31d95e751ab8d6_hq.gif', 'https://static.wikia.nocookie.net/jujutsu-kaisen/images/e/eb/Yuji_kills_Eso_%28Anime%29.gif/revision/latest?cb=20210326212355', 'https://i.pinimg.com/originals/dd/50/38/dd503865ddd00d2269c6c6fdbc5d6780.gif', 'https://64.media.tumblr.com/e93dc6173e09d65c23c2236186847830/a6b79fcbc90f6316-4c/s500x750/2dc4d342ade980dfa1afdab472041932a76237f2.gif', 'https://media.tenor.com/9KDWOUOMfmUAAAAd/mushishi.gif', 'https://giffiles.alphacoders.com/140/140787.gif', 'https://media.tenor.com/h6g0qLKzuZEAAAAC/amaama-to-inazuma-sweetness-and-lightning.gif']
        myModel = keras.models.load_model("../../ML_Basics/my_model")
        score = np.array([score])
        result = myModel.predict(score)
        index = np.argmax(result)
        infoObj = {"name": reference[index], "gif": gifs[index]}
        return Response(infoObj)
